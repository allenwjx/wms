<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE table SYSTEM "http://sources.jungle.net/svn/dtd/table-config-1.0.dtd">

<table sqlname="freight">
    <!-- 不需要配置的列请删除 -->

    <sql id="Freight.columns">
        id, province_code, express_code, first_weight, first_original_price,
        additional_original_price, first_cost_price, additional_cost_price, enabled, gmt_create,
        gmt_modified, create_by, modify_by
    </sql>

    <operation name="insert" paramtype="object">
        <sql>
            INSERT INTO freight (
            province_code, express_code, first_weight, first_original_price,
            additional_original_price, first_cost_price, additional_cost_price, enabled, gmt_create,
            gmt_modified, create_by, modify_by
            ) VALUES (
            ? ,? ,? ,? ,
            ? ,? , ?, ?, CURRENT_TIMESTAMP ,
            CURRENT_TIMESTAMP ,? ,?
            )
        </sql>
    </operation>

    <operation name="delete">
        <sql>
            DELETE FROM freight WHERE
            id = ?
        </sql>
    </operation>

    <operation name="update" paramtype="object">
        <sql>
            UPDATE freight SET
            province_code = ? ,
            express_code = ?,
            first_weight = ? ,
            first_original_price = ? ,
            additional_original_price = ? ,
            first_cost_price = ?,
            additional_cost_price = ?,
            enabled = ?,
            gmt_modified = CURRENT_TIMESTAMP,
            modify_by = ?

            WHERE
            id = ?
        </sql>
    </operation>

    <operation name="queryById" multiplicity="one">
        <sql>
            SELECT
            <include refid="Freight.columns"/>
            FROM freight
            WHERE
            id = ?
        </sql>
    </operation>

    <operation name="queryByProvince" multiplicity="one">
        <sql>
            SELECT
            <include refid="Freight.columns"/>
            FROM freight
            WHERE
            province_code = #provinceCode# AND enabled = 1
        </sql>
    </operation>

    <operation name="queryByPage" paramtype="parameterObject" multiplicity="paging">
        <sql>
            SELECT
            <include refid="Freight.columns"/>
            FROM freight
            WHERE 1=1
            <dynamic>
                <isNotEmpty prepend="AND" property="provinceCode">
                    province_code = #provinceCode#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="expressCode">
                    express_code = #expressCode#
                </isNotEmpty>
                <isNotEmpty prepend="AND" property="enabled">
                    enabled = #enabled#
                </isNotEmpty>
            </dynamic>
            ORDER BY gmt_modified DESC
        </sql>
    </operation>

    <operation name="queryAllEnabled" multiplicity="many">
        <sql>
            SELECT
            <include refid="Freight.columns"/>
            FROM freight
            WHERE enabled = 1;
        </sql>
    </operation>

    <operation name="getPriceByProvinceName" multiplicity="one">
        <sql>
            SELECT
            f.id,
            f.province_code,
            f.express_code,
            f.first_weight,
            f.first_original_price,

            f.additional_original_price,
            f.first_cost_price,
            f.additional_cost_price,
            f.enabled,
            f.gmt_create,

            f.gmt_modified,
            f.create_by,
            f.modify_by

            FROM freight f left join regions r on f.province_code = r.id
            WHERE enabled = 1
            and r.name = #name#
            limit 1;
        </sql>
    </operation>
</table>
